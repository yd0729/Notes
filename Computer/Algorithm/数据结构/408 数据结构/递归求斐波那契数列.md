---
created: 2022-04-05T14:52:13 (UTC +08:00)
tags: [斐波拉契数列, 算法复杂度, 时间复杂度]
source: https://zhuanlan.zhihu.com/p/257214075
author:
---

# 递归求解斐波那契数列

```python
def fib(n):
    if n <= 1:
        return 1
    return fib(n - 1) + fib(n - 2)
```

首先要知道斐波那契数列的通项（特征方程法）．

## 方法 1

斐波那契数列的计算过程很简单。就是简单的

$$
F(n)=F(n-1)+F(n-2)
$$

我们把计算 $F(i)$ 所需的时间记为 $T(i)$ 。然后记计算加法所需的时间为 $1$ ，那么显然有

$$
T(n)=1+T(n-1)+T(n-2)
$$

这一式子可以进行变形。两边同时加 1，得到

$$
T(n)+1=(T(n-1)+1)+(T(n-2)+1)
$$

我们记 $T(n)+1=A(n)$ ，那么显然

$$
A(n)=A(n-1)+A(n-2)
$$

这是一个斐波那契数列，只不过初项有所不同。

但是斐波那契数列的增长率与初项无关。证明如下：

设某斐波那契数列的前两项为 $a,b$ ，令 $c=\max(a, b)$ ，显然这个数列的增长速度不会超过以 $c,c$ 为初项的斐波那契数列。

那么显然，以 $c,c$ 为初项的斐波那契数列，它的元素是

$$
c,c,2c,3c,5c,8c, \cdots , F(n)c
$$

其中每个元素都是以 $1$ 为初项的斐波那契数列的 $c$ 倍。 $c$ 是个常数，因此斐波那契数列无论初项是多少，渐进增长率都是相同的。

因此，可知 $A(n)$ 的渐进增长率与 $F(n)$ 相同，而 $T(n)=A(n)-1$ ，增长率也是一样的，因此有

$$
T(n) \in \Theta(F(n))
$$

即

$$
T(n)\in\Theta((\cfrac{1+\sqrt{5}}{2})^n)
$$

## 证明 2

这是一个更加直观的证明方法。

斐波那契数列的递归计算方法过程中，存在两种递归结点：

- 第 1 种，叶子结点， $F(0), F(1)$ 会直接返回结果，记直接返回所需时间为 $a$ ．
- 第 2 种，内部结点， $i>1$ 时， $F(i)$ 对 $F(i-1)$ 与 $F(i-2)$ 的结果进行相加，记加法与返回结果所需的所有时间为 $b$ ．

而递归求解斐波那契数列的叶子结点数量其实就是 $F(n)$ 。因为所有叶子结点的返回结果都是 1，而递归求解相当于把所有的 1 按照不同的顺序加起来。因为没有结点被丢弃，所有的叶子结点都被加到结果中了，所以叶子结点的数量其实就是 $F(n)$ 的计算结果。

而内部结点的数量其实就是 $F(n)-1$ ，因为每个结点做了一次加法，无论用什么样的顺序将所有的 1 加起来，所需要的加法数量其实都是 $F(n)-1$ 。

因此，一共所需要的时间为

$$
T(n)=aF(n)+b(F(n)-1)=(a+b)F(n)-b
$$

$a, b$ 都是常数，所以有

$$
T(n)\in\Theta((\cfrac{1+\sqrt{5}}{2})^n)
$$
